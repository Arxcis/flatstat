<!DOCTYPE html5>
<html>

<head>
  <meta charset="utf-8" />
  <title>Flatstat | Library</title>
  <link rel="stylesheet" type="text/css" href="../index.css">
  <link rel="stylesheet" type="text/css" href="./index.css">
  <meta property="og:title" content="Flatstat | Library">
  <meta property="og:locale" content="en_US">
  <link rel="canonical" href="https://arxcis.github.io/flatstat/">
  <meta property="og:url" content="https://arxcis.github.io/flatstat/">
  <meta property="og:site_name" content="Flatstat">
  <meta name="twitter:card" content="summary">
  <meta property="twitter:title" content="Flatstat | Library">
  <script type="application/ld+json">{"description":"Statistics for Flatpak packages","@type":"WebSite","headline":"Flatstat","url":"https://arxcis.github.io/flatstat/","name":"Flatstat","@context":"https://schema.org"}</script>
  <meta name="description" content="Statistics for Flatpak packages">
  <meta property="og:description" content="Statistics for Flatpak packages">
</head>

<body>
  <header>
    <a href="/flatstat/">
      <h1 id="title" title="Flatstat | Library">Flatstat</h1>
    </a>
    <nav>
      <a href="/flatstat/" title="Apps">Apps</a>
      <a href="/flatstat/graphs/" title="Graphs">Graphs</a>
      <a href="/flatstat/library/" title="Library" class="active">Library</a>
      <a href="/flatstat/about/" title="About">About</a>
    </nav>
  </header>
  <main>
    <nav>
      <a id="#achievements" title="Flatpak achievements" href="/flatstat/library/#achievements">🏅 achievements</a>
      <a id="#holes" title="Flatpak holes" href="/flatstat/library/#holes">💥 holes</a>
    </nav>
    <section>
      <section id="achievements">
        <!--article> List generated by javascript </article-->
      </section>
      <section id="holes">
        <!--article> List generated by javascript </article-->
      </section>
    </section>
  </main>
</body>
<script type="module">
  import { useJSON } from "../lib/useJSON.js";
  import { useActiveLink } from "../lib/useActiveLink.js";
  import { HOLE_DESCRIPTIONS } from "../lib/holes.js";
  import { ACHIEVEMENT_DESCRIPTIONS } from "../lib/achievements.js";

  useActiveLink("#achievements")
  
  render()
  async function render() {
    const count = await useJSON("../data/flathub/count.json")
    const { achievements: achievementCounts, holes: holeCounts } = count[count.length - 1]; 

    document.querySelector("#achievements").innerHTML = ACHIEVEMENT_DESCRIPTIONS
    .sort((a,b) => (achievementCounts[b.id] ?? 0) - (achievementCounts[a.id] ?? 0))
    .map(achievement => {
      const count = achievementCounts[achievement.id] ?? 0

      return `\
          <article title="🏅 ${achievement.id}, earned by 🕹️ ${count} apps">
            <h3><span>🏅 Achievement: ${achievement.id} </span><span>🕹️ ${count}</span></h3>
            <p>${achievement.description}</p>
          </article>`
    }).join("\n")

    document.querySelector("#holes").innerHTML = HOLE_DESCRIPTIONS
    .sort((a,b) => (holeCounts[b.id] ?? 0) - (holeCounts[a.id] ?? 0))
    .map(hole => {
      const count = holeCounts[hole.id] ?? 0;

      return `\
          <article title="💥 ${hole.id}, punched by 🕹️ ${count} apps">
            <h3><span>💥 Hole: ${hole.id}</span><span>🕹️ ${count}</span></h3>
            <p>${hole.description}</p>
          </article>
  `;
    }).join("\n")
  }
  
</script>

</html>
